<?xml version="1.0" encoding="utf-8"?>
<Report DataSourceName="ReportDataSource" Width="10.6in" UnitOfMeasure="Inch" Name="TrialBalance" Zoom="0.9" xmlns="http://schemas.telerik.com/reporting/2012/3.6">
  <DataSources>
    <SqlDataSource ConnectionString="MSDBContext" SelectCommand="--declare @CompanyId int=1&#xD;&#xA;--declare @BranchId int=1&#xD;&#xA;--declare @FirstDate datetime ='11/23/2014'&#xD;&#xA;--declare @LastDate  datetime = '1/1/2015'&#xD;&#xA;--declare @Scope int      =17   --  0 All accounts&#xD;&#xA;--declare @ShowZeroBalances int = 1  --1 show all accounts 0 show only account have balances &#xD;&#xA;--declare @TypeOfShowing int =1  --  1 Show all balances  2 show debit balances  3 show credit balances &#xD;&#xA;--declare @level int=1&#xD;&#xA;--declare @AccCode nvarchar(50)=1&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA; ---------Scope 0 All Accounts---------------&#xD;&#xA;&#xD;&#xA;-- First insert account tree in temp table for performance &#xD;&#xA;if OBJECT_ID('tempdb..#GL_ChartOfAccounts') is not null drop table #GL_ChartOfAccounts&#xD;&#xA;select * into  #GL_ChartOfAccounts from GLView_ChartOfAccounts&#xD;&#xA;&#xD;&#xA;if @Scope = 0&#xD;&#xA;begin&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select * from (&#xD;&#xA;select Code as AccountCode,AccSort, NameA,NameE,FirstDebit as FirstDebit,FirstCredit as FirstCredit,PeriodDebit as PeriodDebit,PeriodCredit as PeriodCredit,  &#xD;&#xA;FirstDebit + PeriodDebit as  TotalDebit, FirstCredit + PeriodCredit as TotalCredit,&#xD;&#xA;case when (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) &gt;0 then  (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) else 0 end as LastDebit,&#xD;&#xA;case when (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) &gt;0 then  (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) else 0 end as LastCredit&#xD;&#xA;from(&#xD;&#xA;select Code,AccSort,NameA,NameE,sum(FirstDebit) as FirstDebit,sum(FirstCredit) as FirstCredit,sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit from (&#xD;&#xA;&#xD;&#xA;--Select Opening Balance Query&#xD;&#xA;SELECT        GL_ChartOfAccounts.Code,SUBSTRING (GL_ChartOfAccounts.Code, 1, 1) as AccSort, GL_ChartOfAccounts.NameA, GL_ChartOfAccounts.NameE, isnull(DailyVoucher.FirstDebit,0) as FirstDebit, isnull(DailyVoucher.FirstCredit,0) as FirstCredit,0 as PeriodDebit,0 as PeriodCredit&#xD;&#xA;FROM            (SELECT       GL_DailyVoucher_DTL.AccountId, &#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))  else 0 end AS FirstDebit,&#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))-SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) else 0 end AS FirstCredit&#xD;&#xA; FROM   GL_DailyVoucher INNER JOIN GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId&#xD;&#xA;        WHERE  GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast (GL_DailyVoucher_DTL.TransactDate_Gregi as date) &lt; @FirstDate&#xD;&#xA;&#x9;&#x9;GROUP BY GL_DailyVoucher_DTL.AccountId) AS DailyVoucher RIGHT OUTER JOIN&#xD;&#xA;        GL_ChartOfAccounts ON DailyVoucher.AccountId = GL_ChartOfAccounts.Id where GL_ChartOfAccounts.CompanyId in(@CompanyId) and GL_ChartOfAccounts.HasChildren=0 &#xD;&#xA;&#xD;&#xA;union all&#xD;&#xA;&#xD;&#xA;-- Select Transaction Query&#xD;&#xA;SELECT         GL_ChartOfAccounts.Code ,SUBSTRING (GL_ChartOfAccounts.Code, 1, 1) as AccSort, GL_ChartOfAccounts.NameA, GL_ChartOfAccounts.NameE, 0 as FirstDebit,0 as FirstCredit,&#xD;&#xA;              SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) AS PeriodDebit, SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0)) AS PeriodCredit&#xD;&#xA;FROM            GL_DailyVoucher INNER JOIN&#xD;&#xA;                         GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId  INNER JOIN&#xD;&#xA;                         GL_ChartOfAccounts ON GL_DailyVoucher_DTL.AccountId = GL_ChartOfAccounts.Id&#xD;&#xA;WHERE        GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast(GL_DailyVoucher_DTL.TransactDate_Gregi as date) between @FirstDate and @LastDate&#xD;&#xA;GROUP BY GL_ChartOfAccounts.Id, GL_ChartOfAccounts.Code,SUBSTRING (GL_ChartOfAccounts.Code, 1, 1), GL_ChartOfAccounts.NameA, GL_ChartOfAccounts.NameE&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;) as TblG1&#xD;&#xA;&#xD;&#xA; GROUP BY Code,AccSort, NameA,NameE) as TblG2&#xD;&#xA;  )as TblG3&#xD;&#xA;&#xD;&#xA; where ABS( LastDebit- LastCredit)&gt; IIF(@ShowZeroBalances=1,-1,0)  and LastDebit &gt; IIF(@TypeOfShowing=2,0,-1) and LastCredit&gt; IIF(@TypeOfShowing=3,0,-1)&#xD;&#xA; order by AccSort, cast (AccountCode as numeric)&#xD;&#xA; end &#xD;&#xA; ---------End of Scope 0 All Accounts---------------&#xD;&#xA;&#xD;&#xA; ---------Scope Levels---------------&#xD;&#xA; if @Scope &lt; 0&#xD;&#xA; begin&#xD;&#xA;&#xD;&#xA;select * from (&#xD;&#xA;select Code as AccountCode,AccSort,NameA,NameE,FirstDebit ,FirstCredit,PeriodDebit,PeriodCredit ,FirstDebit+ PeriodDebit as TotalDebit,FirstCredit+PeriodCredit as TotalCredit,&#xD;&#xA;case when (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) &gt;0 then  (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) else 0 end as LastDebit,&#xD;&#xA;case when (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) &gt;0 then  (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) else 0 end as LastCredit&#xD;&#xA;from(&#xD;&#xA;select Code,AccSort,NameA,NameE,sum(FirstDebit) as FirstDebit ,sum(FirstCredit) as FirstCredit,sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit  &#xD;&#xA;&#xD;&#xA;from (&#xD;&#xA;select Code,AccSort,NameA,NameE,&#xD;&#xA;case when sum(FirstDebit)-sum(FirstCredit) &gt; 0 then sum(FirstDebit)-sum(FirstCredit) else 0 end  as FirstDebit,&#xD;&#xA;case when sum(FirstCredit)-sum(FirstDebit) &gt; 0 then sum(FirstCredit)-sum(FirstDebit) else 0 end  as FirstCredit,&#xD;&#xA;sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit from (&#xD;&#xA;&#xD;&#xA;--Select Opening Balance Query&#xD;&#xA;SELECT   &#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent1) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent2) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent3) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent4) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent5) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent6) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent7)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent8) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent9)   else #GL_ChartOfAccounts.Code end as Code ,&#xD;&#xA;case @Scope when-1 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent1), 1, 1)  when -2 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent2), 1, 1) when -3 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent3), 1, 1) when -4  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent4), 1, 1) when -5  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent5), 1, 1) when -6  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent6), 1, 1) when -7  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent7), 1, 1)  when -8  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent8), 1, 1) when -9  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent9), 1, 1)   else SUBSTRING (#GL_ChartOfAccounts.Code, 1, 1)  end as AccSort, &#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent1NameA) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent2NameA) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent3NameA) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent4NameA) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent5NameA) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent6NameA) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent7NameA)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent8NameA) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent9NameA)  else #GL_ChartOfAccounts.NameA end as NameA ,&#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent1NameE) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent2NameE) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent3NameE) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent4NameE) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent5NameE) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent6NameE) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent7NameE)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent8NameE) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent9NameE)  else #GL_ChartOfAccounts.NameE end as NameE ,&#xD;&#xA; isnull(DailyVoucher.FirstDebit,0) as FirstDebit, isnull(DailyVoucher.FirstCredit,0) as FirstCredit,0 as PeriodDebit,0 as PeriodCredit&#xD;&#xA;FROM  (SELECT       GL_DailyVoucher_DTL.AccountId, &#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))  else 0 end AS FirstDebit,&#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))-SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) else 0 end AS FirstCredit&#xD;&#xA;FROM   GL_DailyVoucher INNER JOIN GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId&#xD;&#xA;WHERE  GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast(GL_DailyVoucher_DTL.TransactDate_Gregi as date) &lt; @FirstDate&#xD;&#xA;GROUP BY GL_DailyVoucher_DTL.AccountId) AS DailyVoucher RIGHT OUTER JOIN&#xD;&#xA;#GL_ChartOfAccounts ON DailyVoucher.AccountId = #GL_ChartOfAccounts.Id where #GL_ChartOfAccounts.CompanyId in(@CompanyId) and (#GL_ChartOfAccounts.Levels=ABS(@Scope) or  #GL_ChartOfAccounts.HasChildren=0)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;) as OBG1 &#xD;&#xA;group by Code,AccSort,NameA,NameE&#xD;&#xA;&#xD;&#xA;union all&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select Code,AccSort,NameA,NameE,sum(FirstDebit) as FirstDebit,sum(FirstCredit) as FirstCredit,sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit  from (&#xD;&#xA;-- Select Transaction Query&#xD;&#xA;&#xD;&#xA;SELECT   &#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent1) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent2) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent3) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent4) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent5) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent6) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent7)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent8) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent9)   else #GL_ChartOfAccounts.Code end as Code ,&#xD;&#xA;case @Scope when-1 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent1), 1, 1)  when -2 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent2), 1, 1) when -3 then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent3), 1, 1) when -4  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent4), 1, 1) when -5  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent5), 1, 1) when -6  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent6), 1, 1) when -7  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent7), 1, 1)  when -8  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent8), 1, 1) when -9  then SUBSTRING (IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.Code,#GL_ChartOfAccounts.Parent9), 1, 1)   else SUBSTRING (#GL_ChartOfAccounts.Code, 1, 1)  end as AccSort, &#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent1NameA) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent2NameA) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent3NameA) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent4NameA) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent5NameA) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent6NameA) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent7NameA)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent8NameA) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.NameA,#GL_ChartOfAccounts.Parent9NameA)  else #GL_ChartOfAccounts.NameA end as NameA ,&#xD;&#xA;case @Scope when-1 then IIF(#GL_ChartOfAccounts.Parent1=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent1NameE) when -2 then IIF(#GL_ChartOfAccounts.Parent2=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent2NameE) when -3 then IIF(#GL_ChartOfAccounts.Parent3=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent3NameE) when -4  then IIF(#GL_ChartOfAccounts.Parent4=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent4NameE) when -5  then IIF(#GL_ChartOfAccounts.Parent5=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent5NameE) when -6  then IIF(#GL_ChartOfAccounts.Parent6=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent6NameE) when -7  then IIF(#GL_ChartOfAccounts.Parent7=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent7NameE)  when -8  then IIF(#GL_ChartOfAccounts.Parent8=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent8NameE) when -9  then IIF(#GL_ChartOfAccounts.Parent9=0,#GL_ChartOfAccounts.NameE,#GL_ChartOfAccounts.Parent9NameE)  else #GL_ChartOfAccounts.NameE end as NameE ,&#xD;&#xA;0 as FirstDebit,0 as FirstCredit,&#xD;&#xA;ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0) AS PeriodDebit, ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0) AS PeriodCredit&#xD;&#xA;FROM            GL_DailyVoucher INNER JOIN&#xD;&#xA;                         GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId  INNER JOIN&#xD;&#xA;                         #GL_ChartOfAccounts ON GL_DailyVoucher_DTL.AccountId = #GL_ChartOfAccounts.Id&#xD;&#xA;WHERE        GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast(GL_DailyVoucher_DTL.TransactDate_Gregi as date) between @FirstDate and @LastDate&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;) as PG1&#xD;&#xA; group by Code,AccSort,NameA,NameE) as TBLG1&#xD;&#xA; group by Code,AccSort,NameA,NameE) as TBLG2&#xD;&#xA; )as TBLG3&#xD;&#xA; where ABS( LastDebit- LastCredit)&gt; IIF(@ShowZeroBalances=1,-1,0)  and LastDebit &gt; IIF(@TypeOfShowing=2,0,-1) and LastCredit&gt; IIF(@TypeOfShowing=3,0,-1)&#xD;&#xA; order by AccSort , CAST(AccountCode as numeric)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;end&#xD;&#xA; ---------End of Scope Levels---------------&#xD;&#xA;&#xD;&#xA;  ---------Specific Account Scope-------------&#xD;&#xA; if @Scope &gt; 0&#xD;&#xA; begin&#xD;&#xA;&#xD;&#xA; -- First insert account tree in temp table for performance &#xD;&#xA;--if OBJECT_ID('tempdb..#GL_ChartOfAccounts') is not null drop table #GL_ChartOfAccounts&#xD;&#xA;--select * into #GL_ChartOfAccounts  from GLView_ChartOfAccounts&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select * from (&#xD;&#xA;select Code as AccountCode,AccSort,NameA,NameE,FirstDebit ,FirstCredit,PeriodDebit,PeriodCredit ,FirstDebit+ PeriodDebit as TotalDebit,FirstCredit+PeriodCredit as TotalCredit,&#xD;&#xA;case when (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) &gt;0 then  (FirstDebit+PeriodDebit)-(FirstCredit+PeriodCredit) else 0 end as LastDebit,&#xD;&#xA;case when (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) &gt;0 then  (FirstCredit+PeriodCredit)-(FirstDebit+PeriodDebit) else 0 end as LastCredit&#xD;&#xA;from(&#xD;&#xA;select Code,AccSort,NameA,NameE,sum(FirstDebit) as FirstDebit ,sum(FirstCredit) as FirstCredit,sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit  &#xD;&#xA;&#xD;&#xA;from (&#xD;&#xA;select Code,AccSort,NameA,NameE,&#xD;&#xA;case when sum(FirstDebit)-sum(FirstCredit) &gt; 0 then sum(FirstDebit)-sum(FirstCredit) else 0 end  as FirstDebit,&#xD;&#xA;case when sum(FirstCredit)-sum(FirstDebit) &gt; 0 then sum(FirstCredit)-sum(FirstDebit) else 0 end  as FirstCredit,&#xD;&#xA;sum(PeriodDebit) as PeriodDebit,sum(PeriodCredit) as PeriodCredit from (&#xD;&#xA;&#xD;&#xA;--Select Opening Balance Query&#xD;&#xA;SELECT   &#xD;&#xA; #GL_ChartOfAccounts.Code  as Code ,&#xD;&#xA;SUBSTRING (#GL_ChartOfAccounts.Code, 1, 1)   AccSort, #GL_ChartOfAccounts.NameA  as NameA ,#GL_ChartOfAccounts.NameE  as NameE ,&#xD;&#xA; isnull(DailyVoucher.FirstDebit,0) as FirstDebit, isnull(DailyVoucher.FirstCredit,0) as FirstCredit,0 as PeriodDebit,0 as PeriodCredit&#xD;&#xA;FROM  (SELECT       GL_DailyVoucher_DTL.AccountId, &#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))  else 0 end AS FirstDebit,&#xD;&#xA;case when SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))- SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) &gt; 0 then SUM(ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0))-SUM(ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0)) else 0 end AS FirstCredit&#xD;&#xA;FROM   GL_DailyVoucher INNER JOIN GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId&#xD;&#xA;WHERE  GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast(GL_DailyVoucher_DTL.TransactDate_Gregi as date) &lt; @FirstDate&#xD;&#xA;GROUP BY GL_DailyVoucher_DTL.AccountId) AS DailyVoucher RIGHT OUTER JOIN&#xD;&#xA;#GL_ChartOfAccounts ON DailyVoucher.AccountId = #GL_ChartOfAccounts.Id where #GL_ChartOfAccounts.CompanyId in(@CompanyId) and  #GL_ChartOfAccounts.HasChildren=0 &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent1 as numeric) between IIf(@level=1, @AccCode,-88888888888888888888888888) and IIf(@level=1, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent2 as numeric) between IIf(@level=2, @AccCode,-88888888888888888888888888) and IIf(@level=2, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent3 as numeric) between IIf(@level=3, @AccCode,-88888888888888888888888888) and IIf(@level=3, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent4 as numeric) between IIf(@level=4, @AccCode,-88888888888888888888888888) and IIf(@level=4, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent5 as numeric) between IIf(@level=5, @AccCode,-88888888888888888888888888) and IIf(@level=5, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent6 as numeric) between IIf(@level=6, @AccCode,-88888888888888888888888888) and IIf(@level=6, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent7 as numeric) between IIf(@level=7, @AccCode,-88888888888888888888888888) and IIf(@level=7, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent8 as numeric) between IIf(@level=8, @AccCode,-88888888888888888888888888) and IIf(@level=8, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent9 as numeric) between IIf(@level=9, @AccCode,-88888888888888888888888888) and IIf(@level=9, @AccCode,88888888888888888888888888) &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;union all&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Select Transaction Query&#xD;&#xA;SELECT   &#xD;&#xA; #GL_ChartOfAccounts.Code  as Code ,&#xD;&#xA;SUBSTRING (#GL_ChartOfAccounts.Code, 1, 1)   AccSort, #GL_ChartOfAccounts.NameA  as NameA ,#GL_ChartOfAccounts.NameE  as NameE ,&#xD;&#xA;0 as FirstDebit,0 as FirstCredit,&#xD;&#xA;ISNULL(GL_DailyVoucher_DTL.DebitLocal, 0) AS PeriodDebit, ISNULL(GL_DailyVoucher_DTL.CreditLocal, 0) AS PeriodCredit&#xD;&#xA;FROM            GL_DailyVoucher INNER JOIN&#xD;&#xA;                         GL_DailyVoucher_DTL ON GL_DailyVoucher.Id = GL_DailyVoucher_DTL.DailyVoucherId  INNER JOIN&#xD;&#xA;                         #GL_ChartOfAccounts ON GL_DailyVoucher_DTL.AccountId = #GL_ChartOfAccounts.Id&#xD;&#xA;WHERE        GL_DailyVoucher.CompanyId IN (@CompanyId) AND GL_DailyVoucher.BranchId IN (@BranchId) AND cast(GL_DailyVoucher_DTL.TransactDate_Gregi as date) between @FirstDate and @LastDate   &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent1 as numeric) between IIf(@level=1, @AccCode,-88888888888888888888888888) and IIf(@level=1, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent2 as numeric) between IIf(@level=2, @AccCode,-88888888888888888888888888) and IIf(@level=2, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent3 as numeric) between IIf(@level=3, @AccCode,-88888888888888888888888888) and IIf(@level=3, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent4 as numeric) between IIf(@level=4, @AccCode,-88888888888888888888888888) and IIf(@level=4, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent5 as numeric) between IIf(@level=5, @AccCode,-88888888888888888888888888) and IIf(@level=5, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent6 as numeric) between IIf(@level=6, @AccCode,-88888888888888888888888888) and IIf(@level=6, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent7 as numeric) between IIf(@level=7, @AccCode,-88888888888888888888888888) and IIf(@level=7, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent8 as numeric) between IIf(@level=8, @AccCode,-88888888888888888888888888) and IIf(@level=8, @AccCode,88888888888888888888888888) &#xD;&#xA;and cast(#GL_ChartOfAccounts.Parent9 as numeric) between IIf(@level=9, @AccCode,-88888888888888888888888888) and IIf(@level=9, @AccCode,88888888888888888888888888) &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;) as PG1&#xD;&#xA; group by Code,AccSort,NameA,NameE) as TBLG1&#xD;&#xA; group by Code,AccSort,NameA,NameE) as TBLG2&#xD;&#xA; )as TBLG3&#xD;&#xA; where ABS( LastDebit- LastCredit)&gt; IIF(@ShowZeroBalances=1,-1,0)  and LastDebit &gt; IIF(@TypeOfShowing=2,0,-1) and LastCredit&gt; IIF(@TypeOfShowing=3,0,-1)&#xD;&#xA; order by AccSort , CAST(AccountCode as numeric)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA; end&#xD;&#xA;&#xD;&#xA;  ---------End Specific Account Scope-------------&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" CommandTimeout="360" Name="ReportDataSource" ParameterValues="{@CompanyId:1},{@BranchId:1},{@FirstDate:1/1/2014},{@LastDate:1/1/2015},{@Scope:0},{@ShowZeroBalances:1},{@TypeOfShowing:1},{@level:1},{@AccCode:1}">
      <Parameters>
        <SqlDataSourceParameter DbType="Int32" Name="@CompanyId">
          <Value>
            <String>=Parameters.CompanyId.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="String" Name="@BranchId">
          <Value>
            <String>=Parameters.BranchId.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="DateTime" Name="@FirstDate">
          <Value>
            <String>=Parameters.FirstDate.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="DateTime" Name="@LastDate">
          <Value>
            <String>=Parameters.LastDate.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="Int32" Name="@Scope">
          <Value>
            <String>=Parameters.Scope.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="Int32" Name="@ShowZeroBalances">
          <Value>
            <String>=Parameters.ShowZeroBalances.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="Int32" Name="@TypeOfShowing">
          <Value>
            <String>=Parameters.TypeOfShowing.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="Int32" Name="@level">
          <Value>
            <String>=Parameters.level.Value</String>
          </Value>
        </SqlDataSourceParameter>
        <SqlDataSourceParameter DbType="String" Name="@AccCode">
          <Value>
            <String>=Parameters.AccCode.Value</String>
          </Value>
        </SqlDataSourceParameter>
      </Parameters>
    </SqlDataSource>
  </DataSources>
  <Items>
    <DetailSection Height="0.340000176429749in" Name="detailSection1">
      <Style>
        <BorderStyle Top="None" Bottom="Solid" Left="None" Right="None" />
        <BorderColor Top="Black" Bottom="Black" Left="Black" Right="Black" />
        <BorderWidth Top="1pt" Bottom="1pt" Left="1pt" Right="1pt" />
      </Style>
      <Items>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="7.70000076293945in" Top="0in" Value="= Fields.TotalCredit" Format="{0:N2}" Name="textBox49">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="6.80000066757202in" Top="0in" Value="= Fields.TotalDebit" Format="{0:N2}" Name="textBox50">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.00000047683716in" Top="0in" Value="= Fields.PeriodDebit" Name="textBox51">
          <Style TextAlign="Left" VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="3.20000004768372in" Top="0in" Value="= Fields.FirstDebit" Name="textBox52">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="8.59999942779541in" Top="0in" Value="= Fields.LastDebit" Format="{0:N2}" Name="textBox53">
          <Style TextAlign="Left" VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.90000104904175in" Top="0in" Value="= Fields.PeriodCredit" Name="textBox54">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="4.10000038146973in" Top="0in" Value="= Fields.FirstCredit" Name="textBox55">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="8pt" />
          </Style>
        </TextBox>
        <TextBox Width="1.9998431901137in" Height="0.340000003576279in" Left="1.20007885495822in" Top="0in" Value="= Fields.NameE" Name="textBox56">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="1.19996064901352in" Height="0.340000003576279in" Left="0.00003937880198161in" Top="0in" Value="= Fields.AccountCode" Format="{0:dd/MM/yyyy}" Name="textBox5">
          <Style VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
        <TextBox Width="1.09995930393537in" Height="0.339960796964685in" Left="9.5in" Top="0in" Value="= Fields.LastCredit" Format="{0:N2}" Name="textBox16">
          <Style TextAlign="Left" VerticalAlign="Middle">
            <BorderStyle Top="None" Bottom="None" Right="None" />
            <BorderWidth Default="0.5pt" />
            <Font Size="9pt" />
          </Style>
        </TextBox>
      </Items>
    </DetailSection>
    <PageFooterSection Height="0.500000000000001in" Name="pageFooterSection1">
      <Items>
        <TextBox Width="1.20000012715658in" Height="0.199999809265137in" Left="9.3000005086263in" Top="0.200000127156576in" Value="= 'Page ' + PageNumber + ' of ' + PageCount" Name="textBox7" />
        <TextBox Width="2.60000006357829in" Height="0.199999809265137in" Left="4.40000025431315in" Top="0.200000127156576in" Value="='Print date: ' + Now()" Name="textBox8" />
        <TextBox Width="2.60000014305115in" Height="0.199999809265137in" Left="0.100000023841858in" Top="0.200000127156576in" Value="='User: ' + Parameters.UserName.Value" Name="textBox9" />
      </Items>
    </PageFooterSection>
  </Items>
  <StyleSheet>
    <StyleRule>
      <Style>
        <Padding Left="2pt" Right="2pt" />
      </Style>
      <Selectors>
        <TypeSelector Type="TextItemBase" />
        <TypeSelector Type="HtmlTextBox" />
      </Selectors>
    </StyleRule>
    <StyleRule>
      <Style Color="Black">
        <BorderStyle Default="Solid" />
        <BorderColor Default="Black" />
        <BorderWidth Default="1px" />
        <Font Name="Tahoma" Size="9pt" />
      </Style>
      <Selectors>
        <StyleSelector Type="Table" StyleName="Normal.TableNormal" />
      </Selectors>
    </StyleRule>
    <StyleRule>
      <Style VerticalAlign="Middle">
        <BorderStyle Default="Solid" />
        <BorderColor Default="Black" />
        <BorderWidth Default="1px" />
        <Font Name="Tahoma" Size="10pt" />
      </Style>
      <Selectors>
        <DescendantSelector>
          <Selectors>
            <TypeSelector Type="Table" />
            <StyleSelector Type="ReportItem" StyleName="Normal.TableHeader" />
          </Selectors>
        </DescendantSelector>
      </Selectors>
    </StyleRule>
    <StyleRule>
      <Style>
        <BorderStyle Default="Solid" />
        <BorderColor Default="Black" />
        <BorderWidth Default="1px" />
        <Font Name="Tahoma" Size="9pt" />
      </Style>
      <Selectors>
        <DescendantSelector>
          <Selectors>
            <TypeSelector Type="Table" />
            <StyleSelector Type="ReportItem" StyleName="Normal.TableBody" />
          </Selectors>
        </DescendantSelector>
      </Selectors>
    </StyleRule>
  </StyleSheet>
  <PageSettings>
    <PageSettings PaperKind="Letter" Landscape="True">
      <Margins>
        <MarginsU Left="0.2in" Right="0.2in" Top="0.3in" Bottom="0.4in" />
      </Margins>
    </PageSettings>
  </PageSettings>
  <Groups>
    <Group Name="group1">
      <GroupHeader>
        <GroupHeaderSection PrintOnEveryPage="True" Height="1.78000022470951in" Name="groupHeaderSection">
          <Items>
            <TextBox Width="2.24063491821289in" Height="0.227856799960136in" Left="7.85936609903971in" Top="0.485343337059021in" Value="= &quot;Scope: &quot; + Parameters.ScopeName.Value" Name="textBox24">
              <Style>
                <Font Size="11pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.917624751726791in" Height="0.227856794993083in" Left="1.04954036076864in" Top="0.497916539510091in" Value="= Parameters.FirstDate.Value.Date " Format="{0:dd/MM/yyyy}" Name="textBox23" />
            <TextBox Width="1.19996064901352in" Height="0.68000044922034in" Left="0.00003937880319427in" Top="1.09999998410543in" Value="ACCOUNT CODE:" Name="textBox44">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.9998431901137in" Height="0.680000444253286in" Left="1.20007885495822in" Top="1.09999998410543in" Value="ACCOUNT NAME:" Name="textBox43">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="4.10000038146973in" Top="1.44003931681315in" Value="CREDIT:" Name="textBox42">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.90000104904175in" Top="1.44003931681315in" Value="CREDIT:" Name="textBox41">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="8.59999942779541in" Top="1.44003931681315in" Value="DEBIT:" Name="textBox3">
              <Style TextAlign="Left" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="3.20000004768372in" Top="1.44003931681315in" Value="DEBIT:" Name="textBox45">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Left="None" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.00000047683716in" Top="1.44003931681315in" Value="DEBIT:" Name="textBox46">
              <Style TextAlign="Left" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="6.80000066757202in" Top="1.44003931681315in" Value="DEBIT:" Name="textBox47">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="7.70000076293945in" Top="1.44003931681315in" Value="CREDIT:" Name="textBox48">
              <Style VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <SubReport Width="10.4999210039775in" Height="0.300000190734863in" Left="0.00003941853841146in" Top="0in" Name="subReportHeadr">
              <ReportSource>
                <UriReportSource Uri="../HeaderLandScap.trdx">
                  <Parameters>
                    <Parameter Name="CompanyId">
                      <Value>
                        <String>=Parameters.CompanyId.Value</String>
                      </Value>
                    </Parameter>
                    <Parameter Name="Title">
                      <Value>
                        <String>=Parameters.Title.Value</String>
                      </Value>
                    </Parameter>
                  </Parameters>
                </UriReportSource>
              </ReportSource>
            </SubReport>
            <TextBox Width="0.900001207987468in" Height="0.227856799960136in" Left="0.0999999940395355in" Top="0.485343337059021in" Value="From date:" Name="textBox1">
              <Style>
                <Font Size="11pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.900001207987468in" Height="0.227856799960136in" Left="0.0999999940395355in" Top="0.787426630655924in" Value="To date:" Name="textBox2">
              <Style>
                <Font Size="11pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.917624711990356in" Height="0.227856799960136in" Left="1.04954036076864in" Top="0.799999793370565in" Value="= Parameters.LastDate.Value" Format="{0:dd/MM/yyyy}" Name="textBox4" />
            <TextBox Width="0.917624771595001in" Height="0.227856799960136in" Left="1.96724414825439in" Top="0.49999996026357in" Value="= Parameters.FirstDateHijri.Value" Format="" Name="textBox13" />
            <TextBox Width="0.917624771595001in" Height="0.227856799960136in" Left="1.96724414825439in" Top="0.799999952316284in" Value="= Parameters.LastDateHijri.Value" Format="" Name="textBox14" />
            <TextBox Width="1.09995930393537in" Height="0.339960796964685in" Left="9.5in" Top="1.44003931681315in" Value="CREDIT:" Name="textBox15">
              <Style TextAlign="Left" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="Solid" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.79897274573644in" Height="0.339960783720016in" Left="3.20000012715658in" Top="1.09999982515971in" Value="FIRST BALANCE" Name="textBox17">
              <Style TextAlign="Center" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="None" Left="None" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.79897272586823in" Height="0.339960783720016in" Left="4.99905109405518in" Top="1.09999966621399in" Value="PERIOD TRANSACTION" Name="textBox18">
              <Style TextAlign="Center" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="None" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.79897272586823in" Height="0.339960783720016in" Left="6.80094846089681in" Top="1.09999982515971in" Value="TOTAL" Name="textBox19">
              <Style TextAlign="Center" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="None" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.99995924035708in" Height="0.339960783720016in" Left="8.60000038146973in" Top="1.09999982515971in" Value="LAST BALANCE" Name="textBox20">
              <Style TextAlign="Center" VerticalAlign="Middle">
                <BorderStyle Top="Solid" Bottom="None" Right="None" />
                <BorderWidth Default="0.5pt" />
                <Font Size="9pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="2.2406344016393in" Height="0.227856799960136in" Left="7.85936609903971in" Top="0.787426630655924in" Value="= IIf(Parameters.TypeOfShowing.Value=2,&quot;Only Debit Balances&quot;, IIf(Parameters.TypeOfShowing.Value=3,&quot;Only Credit Balances&quot;,&quot;&quot;))" Name="textBox25">
              <Style>
                <Font Size="11pt" Bold="True" />
              </Style>
            </TextBox>
          </Items>
        </GroupHeaderSection>
      </GroupHeader>
      <GroupFooter>
        <GroupFooterSection Height="0.700000127156575in" Name="groupFooterSection">
          <Items>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="3.20000004768372in" Top="0.100039800008138in" Value="= Sum(Fields.FirstDebit)" Format="{0:N2}" Name="textBox6">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="4.10000038146973in" Top="0.100039800008138in" Value="= Sum(Fields.FirstCredit)" Format="{0:N2}" Name="textBox10">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.00000047683716in" Top="0.100000381469727in" Value="= Sum(Fields.PeriodDebit)" Format="{0:N2}" Name="textBox11">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <Shape Width="10.4999604225159in" Height="0.0520833333333333in" Left="0in" Top="0.500000317891439in" Name="shape1">
              <ShapeType>
                <LineShape Direction="EW" />
              </ShapeType>
            </Shape>
            <TextBox Width="0.900001227855682in" Height="0.340000003576279in" Left="2.10680882136027in" Top="0.100039800008138in" Value="Total:" Name="textBox12">
              <Style VerticalAlign="Middle">
                <Font Size="11pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="5.90000104904175in" Top="0.100000351667404in" Value="= sum(Fields.PeriodCredit)" Format="{0:N2}" Name="textBox21">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="6.80000066757202in" Top="0.100000351667404in" Value="= Sum(Fields.TotalDebit)" Format="{0:N2}" Name="textBox22">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="7.70000076293945in" Top="0.100000351667404in" Value="= Sum(Fields.TotalCredit)" Format="{0:N2}" Name="textBox26">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="0.898972789446512in" Height="0.339960796964685in" Left="8.59999942779541in" Top="0.100000351667404in" Value="= Sum(Fields.LastDebit)" Format="{0:N2}" Name="textBox27">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
            <TextBox Width="1.09995930393537in" Height="0.339960796964685in" Left="9.5in" Top="0.100000351667404in" Value="= Sum(Fields.LastCredit)" Format="{0:N2}" Name="textBox28">
              <Style VerticalAlign="Middle">
                <Font Size="8pt" Bold="True" />
              </Style>
            </TextBox>
          </Items>
        </GroupFooterSection>
      </GroupFooter>
    </Group>
  </Groups>
  <ReportParameters>
    <ReportParameter Name="CompanyId" Type="Integer" Text="CompanyId">
      <Value>
        <String>0</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="BranchId" Type="Integer" Text="BranchId">
      <Value>
        <String>0</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="FirstDate" Type="DateTime" Text="FirstDate">
      <Value>
        <String>1/1/2014</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="LastDate" Type="DateTime" Text="LastDate">
      <Value>
        <String>1/1/2015</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="UserName">
      <Value>
        <String>m</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="Title" Text=" ">
      <Value>
        <String>m</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="FirstDateHijri">
      <Value>
        <String>m</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="LastDateHijri">
      <Value>
        <String>m</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="Scope" Type="Integer" Text="Scope">
      <Value>
        <String>1</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="ShowZeroBalances" Type="Integer" Text="ShowZeroBalances">
      <Value>
        <String>1</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="TypeOfShowing" Type="Integer" Text="TypeOfShowing">
      <Value>
        <String>1</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="level" Type="Integer" Text="level">
      <Value>
        <String>1</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="AccCode" Text="AccCode">
      <Value>
        <String>16</String>
      </Value>
    </ReportParameter>
    <ReportParameter Name="ScopeName">
      <Value>
        <String>m</String>
      </Value>
    </ReportParameter>
  </ReportParameters>
</Report>